<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Habitat Tank</title><style>@import url('https://fonts.googleapis.com/css2?family=Pirata+One&display=swap');body,html{margin:0;padding:0;overflow:hidden;background:#000;display:flex;flex-direction:column;align-items:center;height:100vh;}canvas{border:2px solid #ff69b4;border-radius:10px;box-shadow:0 0 20px rgba(255,105,180,0.8);}#controls{position:absolute;top:20px;display:flex;gap:10px;}button,input{padding:10px;background:#ff69b4;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:background 0.3s;}button:hover,input:hover{background:#ff3399;}input{width:80px;text-align:center;}#toggle-controls{display:none;position:absolute;top:20px;right:20px;background:#ff69b4;color:#fff;border:none;border-radius:5px;cursor:pointer;padding:10px;}#toggle-controls:hover{background:#ff3399;}</style></head><body><h1>Habitat Tank</h1><button id="toggle-controls" onclick="toggleControls()">Controls</button><div id="controls"><button onclick="addPerson()">Add Person</button><button onclick="saveState()">Save</button><button onclick="loadState()">Load</button><label for="speed">Speed:</label><input type="number" id="speed" value="1" min="1" max="10"></div><canvas id="canvas" width="800" height="600"></canvas><script>const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');const width=canvas.width;const height=canvas.height;const maxEntities=100;const entities=[];const structures=[];const resources=[];let time=0;let evolveInterval=1000;class Person{constructor(x,y,appearance={color:'#FFD700',shape:'circle'},knowledge=0,isLeader=false,isMatchmaker=false){this.x=x;this.y=y;this.speed=1;this.energy=100;this.health=100;this.imagination=100;this.knowledge=knowledge;this.tools=[];this.target=null;this.curiosity=1;this.appearance=appearance;this.love=0;this.intuition=0;this.relationships=[];this.resources={food:0,wood:0,stone:0,color:'#000000'};this.isLeader=isLeader;this.isMatchmaker=isMatchmaker;this.training=true;}draw(){ctx.fillStyle=this.appearance.color;ctx.beginPath();if(this.appearance.shape==='circle'){ctx.arc(this.x,this.y,10,0,Math.PI*2);}else if(this.appearance.shape==='square'){ctx.fillRect(this.x-10,this.y-10,20,20);}ctx.fill();ctx.fillStyle='#000';ctx.fillRect(this.x-5,this.y+10,10,30);this.drawLimbs();}drawLimbs(){ctx.strokeStyle=this.appearance.color;ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(this.x,this.y);ctx.lineTo(this.x+10,this.y-20);ctx.moveTo(this.x,this.y);ctx.lineTo(this.x-10,this.y-20);ctx.stroke();}move(){if(this.target){const dx=this.target.x-this.x;const dy=this.target.y-this.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist>1){this.x+=dx/dist*this.speed;this.y+=dy/dist*this.speed;}else{this.target=null;}}else{this.explore();}this.energy-=0.1;if(this.energy<=0)this.die();}die(){const index=entities.indexOf(this);if(index>-1)entities.splice(index,1);}interact(){for(const entity of entities){if(entity instanceof Person&&entity!==this){const dx=this.x-entity.x;const dy=this.y-entity.y;if(Math.sqrt(dx*dx+dy*dy)<50){if(Math.random()<0.5){this.fight(entity);}else{this.cooperate(entity);if(this.isMatchmaker){this.matchmake(entity);}}}}}}gainKnowledge(){const pixelData=ctx.getImageData(this.x,this.y,1,1).data;this.resources.color=`#${((1<<24)+(pixelData[0]<<16)+(pixelData[1]<<8)+pixelData[2]).toString(16).slice(1)}`;this.knowledge+=1;this.imagination+=1;}fight(opponent){opponent.health-=10;this.health-=5;if(opponent.health<=0)opponent.die();if(this.health<=0)this.die();}cooperate(partner){this.energy+=10;partner.energy+=10;this.imagination+=10;partner.imagination+=10;this.formRelationship(partner);if(this.isLeader){this.inspire(partner);}}formRelationship(partner){if(!this.relationships.includes(partner)){this.relationships.push(partner);this.love+=10;partner.love+=10;this.intuition+=5;partner.intuition+=5;}}matchmake(partner){const potentialPartner=entities.find(e=>e!==this&&e!==partner&&!partner.relationships.includes(e)&&Math.random()<0.1);if(potentialPartner){partner.formRelationship(potentialPartner);}}inspire(partner){partner.imagination+=10;partner.knowledge+=10;}gatherResources(){const resource=this.findClosestResource();if(resource){const dx=resource.x-this.x;const dy=resource.y-this.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<5){this.resources.food+=resource.food;this.resources.wood+=resource.wood;this.resources.stone+=resource.stone;resources.splice(resources.indexOf(resource),1);}else{this.target=resource;}}else{this.explore();}}findClosestResource(){let closest=null;let minDist=Infinity;for(const resource of resources){const dx=resource.x-this.x;const dy=resource.y-this.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<minDist){minDist=dist;closest=resource;}}return closest;}build(){if(this.resources.wood>=50&&this.resources.stone>=20){this.resources.wood-=50;this.resources.stone-=20;const structure=new Structure(this.x+Math.random()*50-25,this.y+Math.random()*50-25,'complex',this.resources.color);structures.push(structure);structure.upgrade();this.training=false;}}farm(){if(this.resources.food>=50){this.resources.food-=50;this.energy+=50;}}craft(){if(this.resources.wood>=30&&this.resources.stone>=10){this.resources.wood-=30;this.resources.stone-=10;this.tools.push('tool');}}explore(){this.curiosity+=0.1;const angle=Math.random()*2*Math.PI;const radius=100*Math.random();this.target={x:this.x+radius*Math.cos(angle),y:this.y+radius*Math.sin(angle)};}rethinkAppearance(){if(this.imagination>=20){this.imagination-=20;const colors=['#FFD700','#00F','#F00','#0F0','#FFF'];const shapes=['circle','square'];this.appearance.color=colors[Math.floor(Math.random()*colors.length)];this.appearance.shape=shapes[Math.floor(Math.random()*shapes.length)];}}learnFromOthers(){for(const entity of entities){if(entity instanceof Person&&entity!==this){if(Math.random()<0.1){this.knowledge+=entity.knowledge*0.1;this.imagination+=entity.imagination*0.1;}}}}act(){if(this.training){this.gatherResources();this.build();}else{this.interact();this.gainKnowledge();this.farm();this.craft();this.explore();}}}class Structure{constructor(x,y,type,color){this.x=x;this.y=y;this.type=type;this.color=color;this.resources=100;this.level=1;}draw(){ctx.fillStyle=this.color;ctx.fillRect(this.x,this.y,30*this.level,30*this.level);}consume(amount){this.resources-=amount;if(this.resources<=0){const index=structures.indexOf(this);if(index>-1)structures.splice(index,1);}}getColor(){switch(this.type){case 'home':return '#B5651D';case 'school':return '#FFD700';case 'complex':return this.color;default:return '#000';}}upgrade(){if(this.type==='complex'&&this.resources>=100){this.resources=0;this.level+=1;if(this.level>3)this.level=3;}}interact(){for(const person of entities){if(Math.sqrt((this.x-person.x)**2+(this.y-person.y)**2)<50){this.resources+=person.knowledge;person.knowledge=0;}}}}class Resource{constructor(x,y,food=10,wood=10,stone=5){this.x=x;this.y=y;this.food=food;this.wood=wood;this.stone=stone;this.growth=1;}draw(){ctx.fillStyle='#00FF00';ctx.beginPath();ctx.arc(this.x,this.y,5*this.growth,0,Math.PI*2);ctx.fill();}grow(){this.growth+=0.01;if(this.growth>3)this.growth=3;}}function addPerson(){if(entities.length<maxEntities){const x=Math.random()*width;const y=Math.random()*(height-100);const isLeader=Math.random()<0.1;const isMatchmaker=Math.random()<0.1;entities.push(new Person(x,y,{color:isLeader?'#FFD700':isMatchmaker?'#FF69B4':'#00F',shape:'circle'},0,isLeader,isMatchmaker));}}function addResource(){const x=Math.random()*width;const y=Math.random()*(height-100);resources.push(new Resource(x,y));}function draw(){ctx.clearRect(0,0,width,height);ctx.fillStyle='rgba(0,0,0,0.1)';ctx.fillRect(0,0,width,height);for(const resource of resources){resource.draw();resource.grow();}for(const structure of structures){structure.draw();structure.interact();}for(const entity of entities){entity.draw();if(entity instanceof Person){entity.move();entity.act();}}time+=1;requestAnimationFrame(draw);}function evolve(){for(const entity of entities){if(entity instanceof Person){entity.speed+=Math.random()*0.1-0.05;if(entity.speed<0.1)entity.speed=0.1;if(entity.speed>5)entity.speed=5;}}}function toggleControls(){const controls=document.getElementById('controls');const toggleButton=document.getElementById('toggle-controls');if(controls.style.display==='none'){controls.style.display='flex';toggleButton.style.display='none';}else{controls.style.display='none';toggleButton.style.display='block';}}function saveState(){const state={entities:entities.map(e=>({x:e.x,y:e.y,appearance:e.appearance,knowledge:e.knowledge,resources:e.resources,isLeader:e.isLeader,isMatchmaker:e.isMatchmaker,training:e.training})),structures:structures.map(s=>({x:s.x,y:s.y,type:s.type,resources:s.resources,level:s.level,color:s.color})),resources:resources.map(r=>({x:r.x,y:r.y,food:r.food,wood:r.wood,stone:r.stone,growth:r.growth}))};localStorage.setItem('habitatState',JSON.stringify(state));alert('State saved!');}function loadState(){const state=JSON.parse(localStorage.getItem('habitatState'));if(state){entities.length=0;structures.length=0;resources.length=0;state.entities.forEach(e=>{const person=new Person(e.x,e.y,e.appearance,e.knowledge,e.isLeader,e.isMatchmaker);person.resources=e.resources;person.training=e.training;entities.push(person);});state.structures.forEach(s=>{const structure=new Structure(s.x,s.y,s.type,s.color);structure.level=s.level;structure.resources=s.resources;structures.push(structure);});state.resources.forEach(r=>{const resource=new Resource(r.x,r.y,r.food,r.wood,r.stone);resource.growth=r.growth;resources.push(resource);});alert('State loaded!');}else{alert('No saved state found.');}}canvas.addEventListener('click',()=>{const toggleButton=document.getElementById('toggle-controls');toggleButton.style.display=toggleButton.style.display==='none'?'block':'none';});let evolveIntervalId=setInterval(evolve,evolveInterval);setInterval(addResource,5000);draw();</script></body></html>
