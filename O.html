<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Oo: Autonomous Wave AI</title><style>body,html{margin:0;padding:0;overflow:hidden;font-family:Arial,sans-serif;background:#000;}</style></head><body><input type="range" id="speedSlider" min="0.1" max="10" step="0.1" value="1" style="position:fixed;top:10px;left:10px;"><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script><script>
let s,c,r,l,o=[],g={acc:{x:0,y:0,z:0}},bs=0,ac,an,md=[],speed=1;
const m={red:"From the fiery depths, the first spark ignited the cosmos.",green:"Life sprouted from the fertile soil, reaching towards the sun.",blue:"Water flowed, carving valleys and shaping the world.",yellow:"Light spread across the heavens, revealing all things.",white:"Air filled the void, giving breath to the living."};
const v=["A","E","I","O","U"],cs="BCDFGHJKLMNPQRSTVWXYZ".split(""),rar={rest:0.01,action:0.02},cls=['warrior','priest','ruler'];
function init(){s=new THREE.Scene();c=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);r=new THREE.WebGLRenderer({antialias:true});r.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(r.domElement);l=new THREE.PointLight(0xffffff,1,100);l.position.set(50,50,50);s.add(l);c.position.z=10;addInitObj();loadState();setupAudio();animate();}
function addInitObj(){for(let i=0;i<10;i++){createCube(0xff0000);}createDebugCube();}
function animate(){requestAnimationFrame(animate);applySound();o.forEach(obj=>{obj.rotation.x+=obj.restAction.rest*speed;obj.rotation.y+=obj.restAction.rest*speed;obj.position.x+=(Math.random()-0.5)*obj.restAction.action*speed+g.acc.x*0.001;obj.position.y+=(Math.random()-0.5)*obj.restAction.action*speed+g.acc.y*0.001;obj.position.z+=(Math.random()-0.5)*obj.restAction.action*speed+g.acc.z*0.001;if(obj.class==='warrior'){obj.material.color.setHex(0xff0000);}else if(obj.class==='priest'){obj.material.color.setHex(0x00ff00);if(Math.random()<0.01){obj.rotation.x+=0.1;obj.rotation.y+=0.1;}}else if(obj.class==='ruler'){obj.material.color.setHex(0x0000ff);if(Math.random()<0.01){createBuilding();}}});bs++;if(bs%200===0)createBuilding();r.render(s,c);saveState();}
function createLine(x1,y1,z1,x2,y2,z2,col){const mat=new THREE.LineBasicMaterial({color:col});const pts=[];pts.push(new THREE.Vector3(x1,y1,z1));pts.push(new THREE.Vector3(x2,y2,z2));const geo=new THREE.BufferGeometry().setFromPoints(pts);const line=new THREE.Line(geo,mat);imbue(line,col);s.add(line);o.push(line);}
function createSpeedSquare(x,y,z,size,col){createLine(x,y,z,x+size,y,z,col);createLine(x,y,z,x,y+size,z,col);createLine(x,y,z,x+size,y+size,z,col);}
function createCompass(x,y,z,rad,col){const geo=new THREE.CircleGeometry(rad,32);const mat=new THREE.MeshBasicMaterial({color:col,side:THREE.DoubleSide});const circ=new THREE.Mesh(geo,mat);imbue(circ,col);circ.position.set(x,y,z);s.add(circ);o.push(circ);}
function createSpirograph(x,y,z,R,r,O,col){const mat=new THREE.LineBasicMaterial({color:col});const pts=[];for(let t=0;t<Math.PI*2*r/gcd(R,r);t+=0.1){const xPos=(R-r)*Math.cos(t)+O*Math.cos((R-r)/r*t);const yPos=(R-r)*Math.sin(t)-O*Math.sin((R-r)/r*t);pts.push(new THREE.Vector3(x+xPos,y+yPos,z));}const geo=new THREE.BufferGeometry().setFromPoints(pts);const spiro=new THREE.Line(geo,mat);imbue(spiro,col);s.add(spiro);o.push(spiro);}
function gcd(a,b){return b?gcd(b,a%b):a;}
function createCube(col){const geo=new THREE.BoxGeometry();const mat=new THREE.MeshBasicMaterial({color:col});const cube=new THREE.Mesh(geo,mat);cube.position.set(Math.random()*4-2,Math.random()*4-2,Math.random()*4-2);imbue(cube,col);s.add(cube);o.push(cube);}
function createDebugCube(){const geo=new THREE.BoxGeometry(1,1,1);const mat=new THREE.MeshBasicMaterial({color:0x00ff00});const cube=new THREE.Mesh(geo,mat);cube.position.set(0,0,0);s.add(cube);}
function createBuilding(){const bx=Math.random()*8-4,by=Math.random()*8-4;const cols=[0xff0000,0x00ff00,0x0000ff,0xffff00,0xffffff];const col=cols[Math.floor(Math.random()*cols.length)];for(let i=0;i<5;i++){for(let j=0;j<5;j++){createBlock(bx+i*0.2,by+j*0.2,0,col);}}for(let k=0;k<5;k++){createBlock(bx+2*0.2,by+2*0.2,k*0.2,col);}createSpeedSquare(bx,by,0,1,col);createCompass(bx,by,0,1,col);createSpirograph(bx,by,0,1,0.5,0.2,col);}function createBlock(x,y,z,col){const geo=new THREE.BoxGeometry(0.2,0.2,0.2);const mat=new THREE.MeshBasicMaterial({color:col});const block=new THREE.Mesh(geo,mat);block.position.set(x,y,z);imbue(block,col);s.add(block);o.push(block);}
function imbue(obj,col){obj.creationMyth=m[getColName(col)];obj.vowels=v;obj.consonants=cs;obj.restAction=rar;obj.class=cls[Math.floor(Math.random()*cls.length)];console.log("Created a",obj.class,"with color",getColName(col));}
function getColName(col){switch(col){case 0xff0000:return 'red';case 0x00ff00:return 'green';case 0x0000ff:return 'blue';case 0xffff00:return 'yellow';case 0xffffff:return 'white';}}
async function getGyroData(){return new Promise(res=>{if('DeviceMotionEvent'in window){window.addEventListener('devicemotion',e=>{g={acc:e.acceleration,rot:e.rotationRate};res(g);});}else{res({acc:{x:0,y:0,z:0}});}});}
function setupAudio(){navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{ac=new(window.AudioContext||window.webkitAudioContext)();const mic=ac.createMediaStreamSource(stream);an=ac.createAnalyser();an.fftSize=2048;const bufferLength=an.frequencyBinCount;md=new Uint8Array(bufferLength);mic.connect(an);}).catch(err=>{console.error('Error accessing microphone',err);});}
function applySound(){an.getByteTimeDomainData(md);const avg=Math.floor(md.reduce((a,b)=>a+b,0)/md.length);const intensity=avg/128;o.forEach(obj=>{obj.material.color.setHSL((avg/256),1,0.5);obj.scale.set(intensity,intensity,intensity);});}
function saveState(){const state=o.map(obj=>({type:obj.geometry.type,position:obj.position.toArray(),rotation:obj.rotation.toArray(),color:obj.material.color.getHex(),creationMyth:obj.creationMyth,vowels:obj.vowels,consonants:obj.consonants,restAction:obj.restAction,class:obj.class}));localStorage.setItem('waveAIState',JSON.stringify(state));console.log("State saved");}
function loadState(){const ss=JSON.parse(localStorage.getItem('waveAIState'));if(ss){ss.forEach(item=>{let obj;if(item.type==='BoxGeometry'){obj=new THREE.Mesh(new THREE.BoxGeometry(),new THREE.MeshBasicMaterial({color:item.color}));}else if(item.type==='BufferGeometry'){const pts=[];for(let i=0;i<item.position.length;i+=3){pts.push(new THREE.Vector3(item.position[i],item.position[i+1],item.position[i+2]));}obj=new THREE.Line(new THREE.BufferGeometry().setFromPoints(pts),new THREE.LineBasicMaterial({color:item.color}));}else if(item.type==='CircleGeometry'){obj=new THREE.Mesh(new THREE.CircleGeometry(),new THREE.MeshBasicMaterial({color:item.color,side:THREE.DoubleSide}));}obj.position.fromArray(item.position);obj.rotation.fromArray(item.rotation);obj.creationMyth=item.creationMyth;obj.vowels=item.vowels;obj.consonants=item.consonants;obj.restAction=item.restAction;obj.class=item.class;s.add(obj);o.push(obj);});console.log("State loaded");}}
init();getGyroData();setInterval(applySound,100);document.getElementById("speedSlider").addEventListener("input",e=>{speed=e.target.value;});
</script></body>
