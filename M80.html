<html><body style="margin:0;display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;background:#000"><input type="file" id="imageUpload" style="margin-bottom:10px;"><div style="display:flex;justify-content:center;margin-bottom:10px;"><label style="color:#fff;margin-right:10px;">Speed:</label><input type="range" id="speedControl" min="0.01" max="1" step="0.01" value="0.3"><label style="color:#fff;margin-left:20px;margin-right:10px;">Frequency:</label><input type="range" id="frequencyControl" min="0.01" max="1" step="0.01" value="0.1"><label style="color:#fff;margin-left:20px;margin-right:10px;">Effect:</label><input type="range" id="effectControl" min="10" max="200" step="1" value="80"></div><canvas id="canvas" style="background:#000;"></canvas><script>const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),imageUpload=document.getElementById("imageUpload"),speedControl=document.getElementById("speedControl"),frequencyControl=document.getElementById("frequencyControl"),effectControl=document.getElementById("effectControl");let img=new Image(),drawWidth,drawHeight;imageUpload.addEventListener('change',e=>{const reader=new FileReader();reader.onload=event=>{img.onload=()=>{resizeCanvas(),animate()},img.src=event.target.result},reader.readAsDataURL(e.target.files[0])});const resizeCanvas=()=>{canvas.width=.7*window.innerWidth,canvas.height=.7*window.innerHeight};resizeCanvas(),window.addEventListener('resize',resizeCanvas);let angle=0,glitchOffset=0,pulse=0,distortionTimer=0;const drawCreativeMandala=()=>{const waveMagnitudeX=parseFloat(effectControl.value),waveMagnitudeY=.75*waveMagnitudeX,waveFrequencyX=parseFloat(frequencyControl.value),waveFrequencyY=2*waveFrequencyX,aspectRatio=img.width/img.height;drawWidth=canvas.width,drawHeight=canvas.height,canvas.width/canvas.height>aspectRatio?(drawHeight=canvas.height,drawWidth=aspectRatio*drawHeight):(drawWidth=canvas.width,drawHeight=drawWidth/aspectRatio),ctx.clearRect(0,0,canvas.width,canvas.height);const slices=18,sliceAngle=2*Math.PI/slices;for(let i=0;i<slices;i++)ctx.save(),ctx.translate(canvas.width/2,canvas.height/2),ctx.rotate(i*sliceAngle),i%2==0&&applyRadialDistortion(),ctx.scale(1+.1*Math.sin(angle+i),1+.1*Math.cos(angle+i)),ctx.translate(-drawWidth/2,-drawHeight/2),ctx.drawImage(img,glitchOffset,glitchOffset,drawWidth,drawHeight),ctx.restore();ctx.save(),ctx.translate(canvas.width/2,canvas.height/2),ctx.scale(1+.1*Math.sin(pulse),1+.1*Math.sin(pulse)),ctx.globalCompositeOperation="lighter",ctx.drawImage(canvas,-canvas.width/2,-canvas.height/2,canvas.width,canvas.height),ctx.restore()},applyRadialDistortion=()=>{if(distortionTimer++%5==0){const imageData=ctx.getImageData(0,0,canvas.width,canvas.height),data=imageData.data,cx=canvas.width/2,cy=canvas.height/2,maxDist=Math.sqrt(cx*cx+cy*cy),distortionStrength=.05*Math.sin(2*angle);for(let y=0;y<canvas.height;y++)for(let x=0;x<canvas.width;x++){const dx=x-cx,dy=y-cy,dist=Math.sqrt(dx*dx+dy*dy),distortionFactor=1+distortionStrength*(dist/maxDist),srcX=Math.floor(cx+dx*distortionFactor),srcY=Math.floor(cy+dy*distortionFactor);if(srcX>=0&&srcX<canvas.width&&srcY>=0&&srcY<canvas.height){const srcIndex=4*(srcY*canvas.width+srcX),destIndex=4*(y*canvas.width+x);data[destIndex]=data[srcIndex],data[destIndex+1]=data[srcIndex+1],data[destIndex+2]=data[srcIndex+2],data[destIndex+3]=data[srcIndex+3]}}ctx.putImageData(imageData,0,0)}},glitchEffect=()=>{glitchOffset=5*Math.sin(10*angle)},colorShift=()=>{const imageData=ctx.getImageData(0,0,canvas.width,canvas.height),data=imageData.data;for(let i=0;i<data.length;i+=4)data[i]=(data[i]+64*Math.sin(5*angle))%256,data[i+1]=(64*Math.sin(3*angle)+data[i+1])%256,data[i+2]=(64*Math.sin(7*angle)+data[i+2])%256;ctx.putImageData(imageData,0,0)},animate=()=>{drawCreativeMandala(),glitchEffect(),colorShift(),angle+=.05*parseFloat(speedControl.value),pulse+=.1,requestAnimationFrame(animate)};</script></body></html>
